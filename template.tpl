___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Yahoo!広告（検索連動型ショッピング広告） - Conversion測定タグ",
  "brand": {
    "id": "brand_dummy",
    "displayName": "yahoojp-marketing",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Yahoo!広告（検索連動型ショッピング広告）のConversion測定用タグです。\n※タグの実行順序について注意点があります。下の「リンク」にある「ドキュメント」をクリックしてご確認ください。",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "LABEL",
    "name": "product_link",
    "displayName": "\u003ca href\u003d\"https://ads-help.yahoo-net.jp/s/article/H000048550?language\u003dja\"\u003eコンバージョン測定タグを取得、設置する（検索広告（ショッピング））\u003c/a\u003e\u003cbr\u003e\n※タグの実行順序について注意点があります。上の「コンバージョン測定タグを取得、設置する（検索広告（ショッピング））」をクリックしてドキュメントをご確認ください。\u003cbr\u003e\u003cbr\u003e"
  },
  {
    "type": "TEXT",
    "name": "yahoo_conversion_id",
    "displayName": "yahoo_conversion_id",
    "simpleValueType": true,
    "help": "コンバージョン測定タグに記載されているコンバージョンIDを入力してください。"
  },
  {
    "type": "TEXT",
    "name": "yahoo_conversion_label",
    "displayName": "yahoo_conversion_label",
    "simpleValueType": true,
    "help": "タグを識別するためのラベルです。コンバージョン測定タグに記載されているラベルを入力してください。"
  },
  {
    "type": "TEXT",
    "name": "yahoo_conversion_value",
    "displayName": "yahoo_conversion_value",
    "simpleValueType": true,
    "canBeEmptyString": true,
    "help": "1コンバージョンあたりの売上金額を入力してください。"
  },
  {
    "type": "TEXT",
    "name": "yahoo_ssa_merchant_id",
    "displayName": "yahoo_ssa_merchant_id",
    "simpleValueType": true,
    "help": "連携したショップIDを設定します。",
    "canBeEmptyString": true
  },
  {
    "type": "TEXT",
    "name": "yahoo_ssa_order_id",
    "displayName": "yahoo_ssa_order_id",
    "simpleValueType": true,
    "help": "注文ごとに異なる注文IDを設定します。 数字、半角英字、記号（ダッシュやスペースなど）で、半角255文字まで設定できます。",
    "canBeEmptyString": true
  },
  {
    "type": "TEXT",
    "name": "yahoo_ssa_items",
    "displayName": "yahoo_ssa_items",
    "simpleValueType": true,
    "help": "商品情報連携用の情報を設定します。商品のSKU(item_id)、商品の注文ごとの販売数(quantity)、商品単価(price)を配列で設定してください。",
    "canBeEmptyString": true
  },
  {
    "type": "GROUP",
    "name": "Itemkey",
    "displayName": "SSA Items Key",
    "groupStyle": "NO_ZIPPY",
    "subParams": [
      {
        "type": "GROUP",
        "name": "ItemKeyLabel",
        "displayName": "「yahoo_ssa_items」に設定した オブジェクトの各キー",
        "groupStyle": "NO_ZIPPY",
        "subParams": [
          {
            "type": "TEXT",
            "name": "key_item_id",
            "displayName": "Item ID",
            "simpleValueType": true,
            "help": "商品ID(item_id)キー名を入力します。\nデフォルト値である「item_id」から変更しないでください。",
            "defaultValue": "item_id"
          },
          {
            "type": "TEXT",
            "name": "key_quantity",
            "displayName": "quantity",
            "simpleValueType": true,
            "help": "商品個数(quantity)キー名を入力します。デフォルト値である「quantity」から変更しないでください。",
            "defaultValue": "quantity"
          },
          {
            "type": "TEXT",
            "name": "key_price",
            "displayName": "price",
            "simpleValueType": true,
            "help": "商品単価(price)キー名を入力します。デフォルト値である「price」から変更しないでください。",
            "defaultValue": "price"
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
log('data =', data);

const query = require('queryPermission');
const createArgumentsQueue = require('createArgumentsQueue');
const injectScript = require('injectScript');
const url = 'https://s.yimg.jp/images/listing/tool/cv/ytag.js';

const onSuccess = () => {
  log('Conductrics: Script loaded successfully.');  

  let items = '';
  if (data.yahoo_ssa_items) {
    items = data.yahoo_ssa_items.map(
      function(item) {
			return { 
              item_id: item[data.key_item_id], 
              quantity: item[data.key_quantity],  
              price: item[data.key_price]
            };});
  }
  
  let ytag = createArgumentsQueue('ytag', 'yjDataLayer');
  ytag({
      type:'yss_ssa_conversion',
      config:{
        yahoo_conversion_id: data.yahoo_conversion_id,
        yahoo_conversion_label: data.yahoo_conversion_label,
        yahoo_conversion_value: data.yahoo_conversion_value,
        yahoo_ssa_merchant_id: data.yahoo_ssa_merchant_id,
        yahoo_ssa_order_id: data.yahoo_ssa_order_id,
        yahoo_ssa_items: items
      }
  });  
  data.gtmOnSuccess();
};

const onFailure = () => {
  log('Conductrics: Script load failed.');
  data.gtmOnFailure();
};

if (query('inject_script', url)) injectScript(url, onSuccess, onFailure);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ytag"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "yjDataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://s.yimg.jp/images/listing/tool/cv/ytag.js"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Quick Test
  code: runCode();
setup: ''


___NOTES___

Created on 2024/8/23 11:05:33

